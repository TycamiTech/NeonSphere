<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Sphere</title>
    <style>
        body {
            margin: 0;
            overflow: hidden; 
            background-color: #050505; 
            font-family: 'Segoe UI', sans-serif;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            display: block;
        }

        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        /* Instruksi kecil di bawah */
        .instruction {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            pointer-events: none;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>

    <div id="loading">Memuat Visualisasi...</div>
    <div class="instruction">Geser Untuk Memutar<br>Â© Project By Tycami Tech. All rights reserved.

</div>

    <!-- Audio Player -->
    <audio id="backsound" loop playsinline style="display: none;">
        <source src="backsound/struct.mp3" type="audio/mpeg">
        Musik tidak didukung oleh browser Anda
    </audio>

    <div id="canvas-container"></div>

    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.136.0';
        import { OrbitControls } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls.js';

        
        let scene, camera, renderer, controls;
        let sphereGroup;
        let rings = [];
        const loadingText = document.getElementById('loading');

        
        const config = {
            count: 64,           
            radius: 10,          
            lineThickness: 2,    
            rotateSpeed: 0.005,  
            colorSpeed: 0.02,    
        };

        init();
        animate();

        function init() { 
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x050505, 0.02);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 25; 
            camera.position.y = 5;

            
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio); 
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true; 
            controls.dampingFactor = 0.05;

            
            createNeonSphere();

            window.addEventListener('resize', onWindowResize);

            loadingText.style.opacity = 0;

            // Audio autoplay handler untuk mobile dan desktop
            const audio = document.getElementById('backsound');
            audio.volume = 1.0; // Set volume ke 100%
            
            const playAudio = async () => {
                try {
                    audio.muted = false;
                    await audio.play();
                    console.log('Audio berhasil diputar');
                } catch (error) {
                    console.log('Audio playback gagal:', error);
                    // Jika gagal, coba lagi dengan delay
                    setTimeout(() => {
                        audio.play().catch(err => console.log('Retry gagal:', err));
                    }, 1000);
                }
            };
            
            // Coba play segera
            playAudio();
            
            // Juga trigger dengan user interaction untuk memastikan
            const userInteractionHandler = () => {
                playAudio();
                document.removeEventListener('click', userInteractionHandler);
                document.removeEventListener('touchstart', userInteractionHandler);
                document.removeEventListener('keydown', userInteractionHandler);
            };
            
            document.addEventListener('click', userInteractionHandler, { once: true });
            document.addEventListener('touchstart', userInteractionHandler, { once: true });
            document.addEventListener('keydown', userInteractionHandler, { once: true });
        }

        function createNeonSphere() {
            sphereGroup = new THREE.Group();
            scene.add(sphereGroup);

            
            const materialBase = new THREE.LineBasicMaterial({
                color: 0xffffff,
                transparent: true,
                opacity: 0.6,
                blending: THREE.AdditiveBlending 
            });

            for (let i = 0; i < config.count; i++) {
                
                const phi = Math.acos( -1 + ( 2 * i ) / config.count );
                const ringRadius = config.radius * Math.sin( phi );
                const yPos = config.radius * Math.cos( phi );

               
                const curve = new THREE.EllipseCurve(
                    0, 0,            
                    ringRadius, ringRadius, 
                    0, 2 * Math.PI,  
                    false, 0
                );

                const points = curve.getPoints(128); 
                const geometry = new THREE.BufferGeometry().setFromPoints(points);

                
                const ring = new THREE.Line(geometry, materialBase.clone());

                ring.rotation.x = Math.PI / 2; 
                ring.position.y = yPos;

                ring.userData = {
                    id: i,
                    originalY: yPos,
                    phase: i * 0.1 
                };

                sphereGroup.add(ring);
                rings.push(ring);
            }
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            const time = Date.now() * 0.001; 

            
            sphereGroup.rotation.y += config.rotateSpeed;
            sphereGroup.rotation.z = Math.sin(time * 0.2) * 0.1; 

            
            rings.forEach((ring, index) => {
                
                const hue = (time * config.colorSpeed * 5 + ring.userData.phase * 0.2) % 1;
                
                
                ring.material.color.setHSL(hue, 1.0, 0.5);

                
                const breath = Math.sin(time * 2 + ring.userData.phase);
                
                
                const scale = 1 + breath * 0.02; 
                ring.scale.set(scale, scale, 1);

                
                ring.material.opacity = 0.5 + (breath * 0.3);
            });

            controls.update();
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>